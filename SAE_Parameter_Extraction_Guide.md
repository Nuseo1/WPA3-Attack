# SAE Parameter Extraction Guide: Scalar and Finite Field Element
## Comprehensive Step-by-Step Instructions for WPA3-SAE Network Analysis

---

## Overview

To successfully execute the DoS attacks on a WPA3-SAE network, you need to extract two cryptographic parameters from the target access point:

1. **Scalar** (random value generated by AP) – **64 bytes / 128 hex characters**
2. **Finite Field Element** (elliptic curve point) – **128 bytes / 256 hex characters**

⚠️ **CRITICAL:** You must extract **separate Scalar and Finite Field Element values for BOTH frequency bands (2.4 GHz and 5 GHz)**. Each band uses different SAE parameters.

The target network may operate on both bands simultaneously with the same SSID but different cryptographic values.

---

## Phase 1: Hardware Preparation

Perfect. The roles are newly assigned. This is the right way – to use the strengths of the respective hardware in a targeted manner.

### Adapter Assignment Example

- **Scanner & Attacker 2.4 GHz:** wlanXmon (Ralink – better signal strength)
- **Scanner & Attacker 5 GHz:** wlan3mon (new adapter – dedicated 5 GHz)
- **Reserve:** wlan0mon (MediaTek – fallback)

### Signal Quality Assessment

Before extraction, identify which band has the strongest signal to maximize packet capture success:

```bash
# Scan both bands to check signal strength
sudo airodump-ng --band abg wlanXmon
# Note the signal strength (-66 dBm for 2.4 GHz, -80 dBm for 5 GHz in your case)
```

**Strategy:** Start with the band showing the strongest signal (typically 2.4 GHz, which is less directional).

---

## Phase 2: Wireshark Setup

### Step 1: Set the Correct Adapter to the Correct Channel

**For 2.4 GHz Band Extraction:**

Open a terminal and set your Ralink adapter to the target's 2.4 GHz channel:

```bash
# Example: target is on channel 11
sudo iwconfig wlanXmon channel 11
```

Verify the channel was set correctly:

```bash
iwconfig wlanXmon
```

Expected output:
```
wlanXmon  IEEE 802.11bgn  ESSID:off/any
          Mode:Monitor  Frequency:2.462 GHz  Fixed
          Tx-Power=20 dBm
          Retry short limit:7   RTS thr:off
          Fragment thr:off
          Power Management:off
```

**For 5 GHz Band Extraction:**

```bash
# Example: target is on channel 100
sudo iwconfig wlan3mon channel 100
```

### Step 2: Launch Wireshark with Packet Filter

Start Wireshark in a new terminal, bound to your monitor interface:

```bash
# For 2.4 GHz extraction
sudo wireshark -i wlanXmon &

# Or for 5 GHz extraction
sudo wireshark -i wlan3mon &
```

Once Wireshark opens:

1. Click on the network interface in the list (wlanXmon or wlan3mon)
2. Click the **blue shark fin icon** to start capturing
3. In the **filter bar** at the top, paste this display filter:

```
wlan.fc.type_subtype == 0x0b
```

4. Press **Enter**

**What this filter does:**
- `wlan.fc.type_subtype == 0x0b` captures only **802.11 Authentication (Subtype 11) frames**
- Eliminates noise from beacon, probe, and data frames
- Shows only relevant SAE Commit/Confirm packets

---

## Phase 3: Capture the SAE Handshake

### Step 3: Provoke a WPA3-SAE Handshake with Wrong Password

Now force the target AP to transmit the SAE Commit packets containing the Scalar and Finite Field Element.

**Using your smartphone or laptop:**

1. Open **Wi-Fi settings**
2. Find and select the target network (e.g., "Imhotep")
3. When prompted for the password, **intentionally enter an INCORRECT password**
   - Example: If the real password is "SecurePass123", enter "WrongPass999"
   - ⚠️ **DO NOT enter the correct password** – this will complete the handshake and you'll miss the packets
4. Tap **"Connect"** (or equivalent)
5. The connection will fail after 3-5 seconds – this is expected

**During these 5 seconds, the AP sends SAE Commit packets.** Wireshark will capture them.

### Step 4: Identify the Correct Packet

By now, 1-3 packets should appear in Wireshark. Identify the correct one:

**Packet Characteristics:**

| Field | Expected Value |
|-------|---|
| **Source** | MAC address of your connecting device (phone, laptop) |
| **Destination** | BSSID of the target AP (e.g., D4:86:60:A3:F9:6E) |
| **Protocol** | 802.11 |
| **Info** | Should contain: `Authentication, ALGO: SAE (3), Commit` |

**Example of correct packet info:**
```
Authentication, ALGO: SAE (3), Commit
```

**If you see "Open System" instead:**
- This is the wrong packet – ignore it
- Look for the packet with **"ALGO: SAE (3)"** in the Info column

---

## Phase 4: Extract Scalar and Finite Field Element

### Step 5: Expand the Tagged Parameters Section

Click on the packet identified in Step 4. In the **middle pane (Packet Details)**, expand the following hierarchy:

```
▶ Frame (1234 bytes)
  ▶ IEEE 802.11 Wireless Management Frame
    ▶ Fixed parameters
    ▶ Tagged Parameters
      ▶ Tag: Simultaneous Authentication of Equals (SAE)
```

Click each **▶ arrow** to expand the sections.

### Step 6: Locate Scalar and Finite Field Element

Inside the "**Tag: Simultaneous Authentication of Equals**" section, you will see:

```
├─ Scalar: a1b2c3d4e5f6... (64 bytes / 128 hex characters)
└─ Finite field element: 0a1b2c3d4e5f... (128 bytes / 256 hex characters)
```

**Important:** These are hexadecimal representations of the cryptographic values.

**Byte Specifications (for ECC P-256 / Group 19):**
- **Scalar:** 64 bytes = 128 hexadecimal characters (256-bit random number)
- **Finite Field Element:** 128 bytes = 256 hexadecimal characters (uncompressed elliptic curve point: X + Y coordinates, each 64 bytes)

**Your extracted values should match this length:**

Example of correct **Scalar** (128 hex chars):
```
a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890a1b2c3d4e5f6789012345678901234567890123456789012345678901234567
```

Example of correct **Finite Field Element** (256 hex chars):
```
0a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890a1b2c3d4e5f6789012345678901234567890123456789012345678901234567
```

### Step 7: Copy the Values (Without Colons)

Right-click on the **Scalar** field and select:

```
Copy → ...as a Hex Stream
```

**Do NOT select "as Hex Dump"** – you need the hex stream format without line numbers and colons.

**Verification:** Paste the copied value into a text editor and count the characters. Should be **exactly 128 characters** (representing 64 bytes).

```
a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890a1b2c3d4e5f6789012345678901234567890123456789012345678901234567
```

Now right-click on the **Finite field element** field and select:

```
Copy → ...as a Hex Stream
```

**Verification:** Paste this value. Should be **exactly 256 characters** (representing 128 bytes).

```
0a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890a1b2c3d4e5f6789012345678901234567890123456789012345678901234567
```

**Save both values to a file with labels:**

```python
# 2.4 GHz Parameters (MUST be 128 + 256 hex characters respectively)
SAE_SCALAR_2_4_HEX = 'a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890a1b2c3d4e5f6789012345678901234567890123456789012345678901234567'
SAE_FINITE_2_4_HEX = '0a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890a1b2c3d4e5f6789012345678901234567890123456789012345678901234567'
```

---

## Phase 5: Repeat for 5 GHz Band (CRITICAL!)

⚠️ **REPEAT THE ENTIRE PROCESS FOR THE 5 GHz BAND**

Each band has **different** Scalar and Finite Field Element values.

### Steps to Repeat:

1. **Stop the current capture** (press the red square in Wireshark)
2. **Set your 5 GHz adapter to the target's 5 GHz channel:**
   ```bash
   sudo iwconfig wlan3mon channel 100  # or whatever channel the AP uses on 5 GHz
   ```
3. **Change Wireshark's capture interface** to wlan3mon (Interface → Change)
4. **Start capturing again** (blue shark fin icon)
5. **Repeat Step 3:** Connect from your device with the wrong password on the 5 GHz band
6. **Extract Scalar and Finite Field Element** (Steps 4-7)
7. **Verify byte counts:** Scalar should be 128 hex chars, Finite Element should be 256 hex chars
8. **Save with 5 GHz labels:**
   ```python
   # 5 GHz Parameters (MUST be 128 + 256 hex characters respectively)
   SAE_SCALAR_5_HEX = 'b2c3d4e5f6789012345678901234567890123456789012345678901234567890b2c3d4e5f6789012345678901234567890123456789012345678901234567890'
   SAE_FINITE_5_HEX = '1b2c3d4e5f6789012345678901234567890123456789012345678901234567890b2c3d4e5f6789012345678901234567890123456789012345678901234567890b2c3d4e5f6789012345678901234567890123456789012345678901234567890b2c3d4e5f6789012345678901234567890123456789012345678901234567890'
   ```

---

## Phase 6: Configuration

### Insert Values into the Script

Once you have extracted values for BOTH bands (each with correct byte lengths), update the configuration section of `deepseek_python_20260102_862907.py`:

```python
# --- 2. SAE PARAMETERS (EXTRACTED VIA WIRESHARK) ---

# Parameters for 2.4 GHz Network
# SCALAR: Must be exactly 128 hex characters (64 bytes)
# FINITE: Must be exactly 256 hex characters (128 bytes)
SAE_SCALAR_2_4_HEX = 'YOUR_2_4_GHZ_SCALAR_HERE_128_CHARS'
SAE_FINITE_2_4_HEX = 'YOUR_2_4_GHZ_FINITE_HERE_256_CHARS'

# Parameters for 5 GHz Network
# SCALAR: Must be exactly 128 hex characters (64 bytes)
# FINITE: Must be exactly 256 hex characters (128 bytes)
SAE_SCALAR_5_HEX = 'YOUR_5_GHZ_SCALAR_HERE_128_CHARS'
SAE_FINITE_5_HEX = 'YOUR_5_GHZ_FINITE_HERE_256_CHARS'
```

### Validation Before Running

**Check your hex strings:**

```bash
# For 2.4 GHz Scalar (should output 128)
echo -n 'YOUR_SCALAR_VALUE' | wc -c

# For 2.4 GHz Finite (should output 256)
echo -n 'YOUR_FINITE_VALUE' | wc -c

# Repeat for 5 GHz values
```

If counts don't match, go back and re-copy from Wireshark with "...as a Hex Stream" (without colons).

### Script Validation

The script will automatically validate your parameters on startup:

```bash
sudo python3 deepseek_python_20260102_862907.py
```

If parameters are invalid or missing, you'll see:

```
[ERROR] SAE parameters are not configured!
You MUST extract SAE parameters from Wireshark before using this script.
[SCANNER] Display detailed extraction guide...
```

---

## Troubleshooting

### Problem: No packets appear in Wireshark

**Solution:**
- Verify the adapter is on the correct channel: `iwconfig wlanXmon`
- Ensure the filter `wlan.fc.type_subtype == 0x0b` is set
- Increase Wireshark capture buffer size (Capture → Options → Ring buffer)
- Try connecting from a different device

### Problem: Packet appears but shows "Open System" instead of "SAE"

**Solution:**
- The AP may not be using WPA3-SAE, or you selected the wrong packet
- Look for packets containing "ALGO: SAE (3)" in the Info column
- If no SAE packets appear, the target may use WPA3-Transition mode – try connecting multiple times

### Problem: Scalar or Finite Field Element fields not visible

**Solution:**
- Expand "**Tag: Simultaneous Authentication of Equals**" completely
- The fields appear under: `IEEE 802.11 → Auth Frame Body → SAE`
- If still not visible, ensure you selected the **Commit** packet (not Confirm)

### Problem: Hex values contain colons when copied

**Solution:**
- Use "Copy → **...as a Hex Stream**" (not "as Hex Dump")
- The hex stream format removes colons automatically

### Problem: Extracted values are wrong length

**Solution:**
- **Scalar must be exactly 128 hex characters** (64 bytes × 2 = 128 hex chars)
- **Finite Element must be exactly 256 hex characters** (128 bytes × 2 = 256 hex chars)
- If your values are different lengths, you may have:
  - Accidentally copied a Confirm packet instead of Commit (different format)
  - Used "Hex Dump" instead of "Hex Stream"
  - Selected the wrong fields
- **Go back and re-extract** from the Commit packet

---

## Summary

| Parameter | Band | Size | Hex Characters | Status |
|-----------|------|------|---|---|
| **Scalar** | 2.4 GHz | 64 bytes | **128 chars** | Must extract |
| **Finite Element** | 2.4 GHz | 128 bytes | **256 chars** | Must extract |
| **Scalar** | 5 GHz | 64 bytes | **128 chars** | Must extract |
| **Finite Element** | 5 GHz | 128 bytes | **256 chars** | Must extract |

**Total data to extract:** 4 hex strings with combined length of 768 characters (128 + 256 + 128 + 256)

---

## Next Steps

1. ✓ Extract Scalar (128 chars) + Finite Element (256 chars) for **2.4 GHz**
2. ✓ Extract Scalar (128 chars) + Finite Element (256 chars) for **5 GHz**
3. ✓ Verify all values have correct lengths
4. ✓ Insert all four values into script configuration
5. ✓ Configure adapter interfaces in `ADAPTER_KONFIGURATION`
6. ✓ Set `SCANNER_INTERFACE` to your monitor adapter
7. ✓ Run: `sudo python3 deepseek_python_20260102_862907.py`

**References:**
- IEEE Std 802.11-2020 (SAE, Authentication, ECC Group 19 / P-256)
- Paper: "How is your Wi-Fi connection today? DoS attacks on WPA3-SAE" (2022)
- Wireshark Documentation: https://www.wireshark.org/docs/